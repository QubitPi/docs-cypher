<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, minimum-scale=1">
    <meta name="msvalidate.01" content="B5163518CBE4A854B63801277FE5E35C" />
    <meta name="google-site-verification" content="ucqagxjVuq0lJZeLKs0F5AppzK111lNt3IoxU6mzlJE" />
    <meta name="robots" content="index, follow" />
    <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
    <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />

    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-WK23PSS');</script>
<!-- Hotjar Tracking Code for staging -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:3587741,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
<!-- End Hotjar Tracking code -->
    <title>Examples - Cypher Manual</title>
    <link rel="prev" href="../syntax/">
    <link rel="next" href="../../query-tuning/">
      <meta name="description" content="Examples of how to manage constraints used for ensuring data integrity.">
<link rel="stylesheet" href="https://neo4j.com/wp-content/themes/neo4jweb/assets/neo4j-react-modules-assets/search-preact/chunkless/bundle.css" />
<link rel="stylesheet" href="https://neo4j.com/wp-content/themes/neo4jweb/assets/neo4j-react-modules-assets/search-preact/chunkless/utilities.min.css" />

    <link rel="preload" href="../../../../assets/fonts/fontawesome-webfont.woff2?v=4.7.0" as="font">
    <link rel="stylesheet" href="../../../../assets/css/site.css">
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">

    <link rel="shortcut icon" href="https://neo4j.com/wp-content/themes/neo4jweb/favicon.ico" />



    <meta property="neo:type" content="Docs">
    <meta property="neo:site" content="Reference Docs">


    <meta property="og:site_name" content="Neo4j Graph Data Platform" />
    <meta property="article:publisher" content="https://www.facebook.com/neo4j.graph.database" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:creator" content="@neo4j" />
    <meta name="twitter:site" content="@neo4j" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Examples - Cypher Manual" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:image" content="https://dist.neo4j.com/wp-content/uploads/20210423062553/neo4j-social-share-21.png" />
    <meta property="og:description" content="Examples of how to manage constraints used for ensuring data integrity." />
    <meta property="og:url" content="https://neo4j.com/docs/cypher-manual/5/constraints/examples/" />
    <link rel="shortcut icon" href="https://neo4j.com/wp-content/themes/neo4jweb/favicon.ico" />
  </head>
  <body class="article docs">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WK23PSS"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<script>(function(f,b){if(!b.__SV){var e,g,i,h;window.mixpanel=b;b._i=[];b.init=function(e,f,c){function g(a,d){var b=d.split(".");2==b.length&&(a=a[b[0]],d=b[1]);a[d]=function(){a.push([d].concat(Array.prototype.slice.call(arguments,0)))}}var a=b;"undefined"!==typeof c?a=b[c]=[]:c="mixpanel";a.people=a.people||[];a.toString=function(a){var d="mixpanel";"mixpanel"!==c&&(d+="."+c);a||(d+=" (stub)");return d};a.people.toString=function(){return a.toString(1)+".people (stub)"};i="disable time_event track track_pageview track_links track_forms track_with_groups add_group set_group remove_group register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking start_batch_senders people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user people.remove".split(" ");
for(h=0;h<i.length;h++)g(a,i[h]);var j="set set_once union unset remove delete".split(" ");a.get_group=function(){function b(c){d[c]=function(){call2_args=arguments;call2=[c].concat(Array.prototype.slice.call(call2_args,0));a.push([e,call2])}}for(var d={},e=["get_group"].concat(Array.prototype.slice.call(arguments,0)),c=0;c<j.length;c++)b(j[c]);return d};b._i.push([e,f,c])};b.__SV=1.2;e=f.createElement("script");e.type="text/javascript";e.async=!0;e.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?
MIXPANEL_CUSTOM_LIB_URL:"file:"===f.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";g=f.getElementsByTagName("script")[0];g.parentNode.insertBefore(e,g)}})(document,window.mixpanel||[]);
mixpanel.init("4bfb2414ab973c741b6f067bf06d5575", {batch_requests: true})
mixpanel.track("Page View", {
    pathname: window.location.origin + window.location.pathname,
    search: window.location.search,
    hash: window.location.hash,
    referrer: document.referrer,
})
</script>
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">

      <img class="navbar-logo" src="https://dist.neo4j.com/wp-content/uploads/20210422142941/neo4j-logo-2020.svg" alt="Neo4j Docs" />
      <a href="/docs/" class="navbar-item no-left-padding" aria-label="Docs">
        Docs
      </a>

      </div>

      <button class="navbar-search search-button" data-target="topbar-nav" id="search_open_mobile" aria-label="Open Search">
        <svg width="23px" height="23px" viewBox="0 0 23 23" version="1.1" class="fill-current float-right" id="searchx" role="button" title="Search Website">
          <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round"
            stroke-linejoin="round">
            <g transform="translate(-2.000000, -2.000000)" stroke="#a0aec0" stroke-width="1.5">
              <circle
                transform="translate(11.389364, 11.388564) rotate(-23.025000) translate(-11.389364, -11.388564) "
                cx="11.3893642" cy="11.3885639" r="8.056"></circle>
              <path d="M17.0853333,17.0844444 L23.3333333,23.3333333" ></path>
            </g>
          </g>
        </svg>
      </button>
      <button class="navbar-burger" data-target="topbar-nav" aria-label="Mobile Navigation Button">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
            <div class="navbar-end">


        <div class="navbar-item has-dropdown is-hoverable docs">
          <a class="navbar-link" href="/docs/">Docs</a>
          <div class="navbar-dropdown">
            <div class="navbar-item project">
              <span class="project-name">Neo4j DBMS</span>
              <ul class="project-links">
                <li><a href="/docs/getting-started/current/" class="project-link">Getting Started</a></li>
                <li><a href="/docs/operations-manual/current/" class="project-link">Operations</a></li>
                <li><a href="/docs/migration-guide/current/" class="project-link">Migration and Upgrade</a></li>
                <li><a href="/docs/status-codes/current/" class="project-link">Status Codes</a></li>
                <li><a href="/docs/java-reference/current/" class="project-link">Java Reference</a></li>
                <li><a href="/docs/kerberos-add-on/current/" class="project-link">Kerberos Add-on</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <a class="project-name" href="/docs/aura/">Neo4j Aura</a>
              <ul class="project-links">
                <li><a class="project-link" href="/docs/aura">Neo4j Aura</a></li>
                <li><a class="project-link" href="/docs/aura/auradb/">Neo4j AuraDB</a></li>
                <li><a class="project-link" href="/docs/aura/aurads/">Neo4j AuraDS</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <span class="project-name">Neo4j Tools</span>
              <ul class="project-links">
                <li><a href="/docs/bloom-user-guide/current/" class="project-link">Neo4j Bloom</a></li>
                <li><a href="/docs/browser-manual/current/" class="project-link">Neo4j Browser</a></li>
                <li><a href="/docs/data-importer/current/" class="project-link">Neo4j Data Importer</a></li>
                <li><a href="/docs/desktop-manual/current/" class="project-link">Neo4j Desktop</a></li>
                <li><a href="/docs/ops-manager/current/" class="project-link">Neo4j Ops Manager</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <span class="project-name">Neo4j Graph Data Science</span>
              <ul class="project-links">
                <li><a href="/docs/graph-data-science/current/" class="project-link">Neo4j Graph Data Science Library</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <span class="project-name">Cypher Query Language</span>
              <ul class="project-links">
                <li><a href="/docs/cypher-manual/current/" class="project-link">Cypher</a></li>
                <li><a href="/docs/cypher-cheat-sheet/current/" class="project-link">Cypher Cheat Sheet</a></li>
                <li><a href="/docs/apoc/current/" class="project-link">APOC Library</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <span class="project-name" href="/docs/drivers-apis">Create applications</span>
              <ul class="project-links">
                <li><a href="/docs/python-manual/current/" class="project-link">Python Driver</a></li>
                <li><a href="/docs/go-manual/current/" class="project-link">Go Driver</a></li>
                <li><a href="/docs/java-manual/current/" class="project-link">Java Driver</a></li>
                <li><a href="/docs/javascript-manual/current/" class="project-link">JavaScript Driver</a></li>
                <li><a href="/docs/dotnet-manual/current/" class="project-link">.Net Driver</a></li>
                <li><a href="/docs/graphql-manual/current/" class="project-link">Neo4j GraphQL Library</a></li>
                <li><a href="/docs/http-api/current/" class="project-link">HTTP API</a></li>
                <li><a href="/docs/ogm-manual/current/" class="project-link">OGM Library</a></li>
                <li><a href="https://docs.spring.io/spring-data/neo4j/docs/current/reference/html/#reference" class="project-link">Spring Data Neo4j</a></li>
                <li><a href="/docs/spark/" class="project-link">Neo4j Connector for Apache Spark</a></li>
                <li><a href="/docs/kafka/" class="project-link">Neo4j Connector for Apache Kafka</a></li>
              </ul>
            </div>

          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable labs">
          <a class="navbar-link" href="/labs/">Labs</a>
          <div class="navbar-dropdown">
            <div class="navbar-item project">
              <a class="project-name" href="/labs/arrows/">arrows.app</a>
              <ul class="project-links">
                <li><a href="/labs/arrows/" class="project-link">Details</a></li>
                <li><a href="https://arrows.app" class="project-link">arrows.app</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/apoc/">APOC Extended</a>

              <ul class="project-links">
                <li><a href="/labs/apoc/5/" class="project-link">Documentation</a></li>
                <li><a href="/developer/neo4j-apoc/" class="project-link">Developer Guide</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/halin/">Halin</a>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/etl-tool/">ETL Tool</a>
              <ul class="project-links">
                <li><a href="/labs/etl-tool/" class="project-link">Details</a></li>
                <li><a href="/labs/etl-tool/1.5.0/" class="project-link">Documentation</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/neo4j-migrations/">Neo4j Migrations</a>
              <ul class="project-links">
                <li><a href="/labs/neo4j-migrations/" class="project-link">Details</a></li>
                <li><a href="/labs/neo4j-migrations/2.0/" class="project-link">Documentation</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/liquibase/">Neo4j Plugin For Liquibase</a>
              <ul class="project-links">
                <li><a href="/labs/liquibase/" class="project-link">Details</a></li>
                <li><a href="https://github.com/liquibase/liquibase-neo4j" class="project-link">Documentation</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/neosemantics/">Neosemantics</a>
              <ul class="project-links">
                <li><a href="/labs/neosemantics/tutorial/" class="project-link">Getting Started</a></li>
                <li><a href="/labs/neosemantics/4.0/" class="project-link">Documentation</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/neo4j-helm/">Neo4j Helm</a>
              <ul class="project-links">
                <li><a href="/labs/neo4j-helm/" class="project-link">Details</a></li>
                <li><a href="/labs/neo4j-helm/1.0.0/" class="project-link">Documentation</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/neodash/">NeoDash</a>
              <ul class="project-links">
                <li><a href="/labs/neodash/" class="project-link">Details</a></li>
                <li><a href="/labs/neodash/2.1/" class="project-link">Documentation</a></li>
              </ul>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/labs/neomodel/">neomodel</a>
              <ul class="project-links">
                <li><a href="/labs/neomodel/" class="project-link">Details</a></li>
                <li><a href="https://neomodel.readthedocs.io/en/latest/" target="_blank" class="project-link">Documentation</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable developer">
          <a class="navbar-link" href="/developer/resources/">Get Help</a>
          <div class="navbar-dropdown">
            <div class="navbar-item project">
              <a class="project-name" href="https://graphacademy.neo4j.com/?ref=docs" target="_blank">GraphAcademy</a>
              <ul class="project-links">
                <li><a class="project-link" href="https://graphacademy.neo4j.com/?ref=docs">Free, Self Paced Training</a></li>
                <li><a class="project-link" href="https://graphacademy.neo4j.com/certification/?ref=docs" target="_blank">Certification</a></li>
              </ul>
            </div>

            <div class="navbar-item project">
              <a class="project-name" href="https://dev.neo4j.com/forum" target="_blank">Community Forum</a>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="https://dev.neo4j.com/chat" target="_blank">Discord Chat</a>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="/developer/kb" target="_blank">Knowledge Base</a>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="https://medium.com/neo4j" target="_blank">Neo4j Developer Blog</a>
            </div>
            <div class="navbar-item project">
              <a class="project-name" href="https://www.youtube.com/neo4j" target="_blank">Neo4j Videos</a>
            </div>
          </div>
        </div>
        <div class="navbar-item is-hoverable getting-started-cta">
          <a class="navbar-link primary" href="https://neo4j.com/cloud/platform/aura-graph-database/?ref=docs-nav-get-started">Get Started Free</a>
        </div>
        <div class="navbar-item">
          <a class="navbar-link search-button" href="#search" id="search_open"><svg width="23px" height="23px" viewBox="0 0 23 23"
              version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
              class="fill-current float-right" id="search" role="button" title="Search Website">
              <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round"
                stroke-linejoin="round">
                <g transform="translate(-2.000000, -2.000000)" stroke="#a0aec0" stroke-width="1.5">
                  <circle
                    transform="translate(11.389364, 11.388564) rotate(-23.025000) translate(-11.389364, -11.388564) "
                    cx="11.3893642" cy="11.3885639" r="8.056"></circle>
                  <path d="M17.0853333,17.0844444 L23.3333333,23.3333333" ></path>
                </g>
              </g>
            </svg><span class="navbar-mobile">Search</span></a>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="cypher-manual" data-version="5">
  <aside class="nav">
    <div class="panels">
      <div class="selectors">
        
      </div>
      <div class="nav-panel-menu is-active" data-panel="menu">
    <nav class="nav-menu">
    <ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../introduction/">Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../introduction/cypher_overview/">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../introduction/cypher_neo4j/">Cypher and Neo4j</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../introduction/cypher_aura/">Cypher and Aura</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../queries/">Queries</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../queries/concepts/">Core concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../queries/basic/">Basic queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../queries/expressions/">Cypher expressions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../queries/case/">Conditional expressions (CASE)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../clauses/">Clauses</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/clause_composition/">Clause composition</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/match/">MATCH</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/optional-match/">OPTIONAL MATCH</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/return/">RETURN</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/with/">WITH</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/unwind/">UNWIND</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/where/">WHERE</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/order-by/">ORDER BY</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/skip/">SKIP</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/limit/">LIMIT</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/create/">CREATE</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/delete/">DELETE</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/set/">SET</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/remove/">REMOVE</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/foreach/">FOREACH</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/merge/">MERGE</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/call/">CALL procedure</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/union/">UNION</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/use/">USE</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/load-csv/">LOAD CSV</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/listing-functions/">SHOW FUNCTIONS</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/listing-procedures/">SHOW PROCEDURES</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/listing-settings/">SHOW SETTINGS</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/transaction-clauses/#query-listing-transactions">SHOW TRANSACTIONS</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../clauses/transaction-clauses/#query-terminate-transactions">TERMINATE TRANSACTIONS</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../subqueries/">Subqueries</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../subqueries/call-subquery/">CALL subqueries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../subqueries/subqueries-in-transactions/">CALL subqueries in transactions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../subqueries/existential/">EXISTS subqueries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../subqueries/count/">COUNT subqueries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../subqueries/collect/">COLLECT subqueries</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../patterns/">Patterns</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../patterns/concepts/">Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../patterns/primer/">Primer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../patterns/reference/">Syntax and semantics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../values-and-types/">Values and types</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../values-and-types/property-structural-constructed/">Property, structural, and constructed values</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../values-and-types/temporal/">Temporal values</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../values-and-types/spatial/">Spatial values</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../values-and-types/working-with-null/">Working with <code>null</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../values-and-types/lists/">Lists</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../values-and-types/maps/">Maps</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../values-and-types/casting-data/">Casting data values</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../values-and-types/type-predicate/">Type predicate expressions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../functions/">Functions</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/predicate/">Predicate functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/scalar/">Scalar functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/aggregating/">Aggregating functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/list/">List functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/mathematical-numeric/">Mathematical functions - numeric</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/mathematical-logarithmic/">Mathematical functions - logarithmic</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/mathematical-trigonometric/">Mathematical functions - trigonometric</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/string/">String functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/temporal/">Temporal functions - instant types</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/temporal/duration/">Temporal functions - duration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/spatial/">Spatial functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/load-csv/">LOAD CSV functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/graph/">Graph functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/database/">Database functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/user-defined/">User-defined functions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../indexes-for-search-performance/">Indexes for search performance</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../indexes-for-full-text-search/">Full-text search index</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../indexes-for-vector-search/">Vector search index</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../">Constraints</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/">Syntax</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="./">Examples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../query-tuning/">Query tuning</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../query-tuning/query-options/">Cypher query options</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../query-tuning/query-profile/">Profile a query</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../query-tuning/indexes/">The use of indexes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../query-tuning/basic-example/">Basic query tuning example</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../query-tuning/advanced-example/">Advanced query tuning example</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../query-tuning/using/">Planner hints and the USING keyword</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../execution-plans/">Execution plans</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../execution-plans/db-hits/">Database hits</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../execution-plans/operator-summary/">Execution plan operators</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../execution-plans/operators/">Execution plan operators in detail</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../execution-plans/shortestpath-planning/">Shortest path planning</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../query-caches/">Query caches</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../query-caches/unified-query-caches/">Unifying query caches</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../administration/">Administration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../administration/databases/">Database management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../administration/aliases/">Database alias management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../administration/servers/">Server management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link nav-item-toggle" href="../../administration/access-control/">Access control</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/access-control/manage-users/">Managing users</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/access-control/manage-roles/">Managing roles</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/access-control/manage-privileges/">Managing privileges</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/access-control/built-in-roles/">Built-in roles and privileges</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/access-control/privileges-reads/">Read privileges</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/access-control/privileges-writes/">Write privileges</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/access-control/database-administration/">Database administration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/access-control/dbms-administration/">DBMS administration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/access-control/load-privileges/">Load privileges</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/access-control/limitations/">Limitations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/access-control/privileges-immutable/">Immutable privileges</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-item-toggle" href="../../syntax/">Syntax</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../syntax/parsing/">Parsing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../syntax/naming/">Naming rules and recommendations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../syntax/variables/">Variables</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../syntax/reserved/">Reserved keywords</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../syntax/parameters/">Parameters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../syntax/operators/">Operators</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../syntax/comments/">Comments</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../deprecations-additions-removals-compatibility/">Deprecations, additions, and compatibility</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../keyword-glossary/">Glossary of keywords</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text nav-item-toggle">Appendix</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../styleguide/">Cypher styleguide</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
  <div class="toolbar-wrapper">
    <button class="nav-toggle" aria-label="Toggle Table of Contents"></button>
    <a href="../../introduction/" class="home-link" aria-label="Go to home page"></a>
    <nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../introduction/">Cypher Manual</a></li>
    <li><a href="../">
        Constraints
    </a></li>
    <li><a href="./">
        Examples
    </a></li>
  </ul>
</nav>
      </div>
</div>

  <div class="content">
<article class="doc">
<div class="sect-header">
<h1 class="page">Examples</h1>
</div>





<div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
<div class="paragraph">
<p>Examples of how to manage constraints used for ensuring data integrity.</p>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="constraints-examples-node-uniqueness"><a class="anchor" href="#constraints-examples-node-uniqueness"></a>Node property uniqueness constraints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A node property uniqueness constraint ensures that certain nodes have a set of specified properties whose combined value is unique when all properties exist on the node.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#constraints-create-a-node-uniqueness-constraint">Create a node property uniqueness constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-uniqueness-constraint-if-not-exist">Handling existing constraints when creating a constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-uniqueness-constraint-with-index-provider">Specifying an index provider when creating a constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-an-already-existing-node-uniqueness-constraint">Creating an already existing constraint will fail</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-uniqueness-constraint-on-same-schema-as-existing-index">Creating a constraint on the same schema as an existing index will fail</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-that-complies-with-a-uniqueness-constraint">Creating a node that complies with an existing constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-that-violates-a-uniqueness-constraint">Creating a node that violates an existing constraint will fail</a></p>
</li>
<li>
<p><a href="#constraints-fail-to-create-a-uniqueness-constraint-due-to-conflicting-nodes">Creating a constraint when there exist conflicting nodes will fail</a></p>
</li>
</ul>
</div>
<h3 id="constraints-create-a-node-uniqueness-constraint" class="discrete">Create a node property uniqueness constraint</h3>
<div class="paragraph">
<p>When creating a property uniqueness constraint, it is recommended to provide a constraint name.</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT book_isbn
FOR (book:Book) REQUIRE book.isbn IS UNIQUE</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 constraint.</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The detailed statistics view currently says <code>Unique constraints added: 1</code>.
It will be updated to say <code>Node property uniqueness constraints added: 1</code> in Neo4j version 6.0.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-uniqueness-constraint-if-not-exist" class="discrete">Handling existing constraints when creating a constraint</h3>
<div class="paragraph">
<p>Creating an already existing constraint will fail.
To avoid such an error, <code>IF NOT EXISTS</code> can be added to the <code>CREATE</code> command.
This will ensure that no error is thrown and that no constraint is created if any other constraint with the given name, or another node property uniqueness constraint on the same schema, already exists.</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT book_isbn2 IF NOT EXISTS
FOR (book:Book) REQUIRE book.isbn2 IS UNIQUE</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming no constraint with the given name or other node property uniqueness constraint on the same schema already exists, the query will return:</p>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 constraint.</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The detailed statistics view currently says <code>Unique constraints added: 1</code>.
It will be updated to say <code>Node property uniqueness constraints added: 1</code> in Neo4j version 6.0.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-uniqueness-constraint-with-index-provider" class="discrete">Specifying an index provider when creating a constraint</h3>
<div class="paragraph">
<p>To create a property uniqueness constraint with a specific index provider for the backing index, the <code>OPTIONS</code> clause is used.</p>
</div>
<div class="paragraph">
<p>The index type of the backing index is set with the <code>indexProvider</code> option.</p>
</div>
<div class="paragraph">
<p>The only valid value for the index provider is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>range-1.0</code> <span class="label label--default">Default</span></p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 3. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT constraint_with_options
FOR (book:Book) REQUIRE (book.prop1, book.prop2) IS UNIQUE
OPTIONS {
  indexProvider: 'range-1.0'
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 constraint.</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The detailed statistics view currently says <code>Unique constraints added: 1</code>.
It will be updated to say <code>Node property uniqueness constraints added: 1</code> in Neo4j version 6.0.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>There is no valid index configuration values for the constraint-backing range indexes.</p>
</div>
<h3 id="constraints-create-an-already-existing-node-uniqueness-constraint" class="discrete">Creating an already existing constraint will fail</h3>
<div class="exampleblock">
<div class="title">Example 4. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a property uniqueness constraint on the property <code>published</code> on nodes with the <code>Book</code> label, when that constraint already exists:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT book_published FOR (book:Book) REQUIRE book.published IS UNIQUE</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because it already exists.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Constraint already exists:
Constraint( id=4, name='preExisting_book_published', type='UNIQUENESS', schema=(:Book {published}), ownedIndex=3 )</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The constraint type will be updated to say <code>NODE PROPERTY UNIQUENESS</code> in Neo4j version 6.0.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-uniqueness-constraint-on-same-schema-as-existing-index" class="discrete">Creating a constraint on the same schema as an existing index will fail</h3>
<div class="exampleblock">
<div class="title">Example 5. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a property uniqueness constraint on the property <code>wordCount</code> on nodes with the <code>Book</code> label, when an index already exists on that label and property combination:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT book_word_count FOR (book:Book) REQUIRE book.wordCount IS UNIQUE</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because there already exists an index covering that schema.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">There already exists an index (:Book {wordCount}).
A constraint cannot be created until the index has been dropped.</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-that-complies-with-a-uniqueness-constraint" class="discrete">Creating a node that complies with an existing constraint</h3>
<div class="exampleblock">
<div class="title">Example 6. CREATE NODE</div>
<div class="content">
<div class="paragraph">
<p>Create a <code>Book</code> node with an <code>isbn</code> that is not already in the graph:</p>
</div>
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE (book:Book {isbn: '1449356265', title: 'Graph Databases'})</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 label, created 1 node, set 2 properties</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-that-violates-a-uniqueness-constraint" class="discrete">Creating a node that violates an existing constraint will fail</h3>
<div class="exampleblock">
<div class="title">Example 7. CREATE NODE</div>
<div class="content">
<div class="paragraph">
<p>Create a <code>Book</code> node with an <code>isbn</code> that is already used in the graph:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE (book:Book {isbn: '1449356265', title: 'Graph Databases'})</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the node is not created because the <code>isbn</code> property is in conflict with an existing constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Node(0) already exists with label `Book` and property `isbn` = '1449356265'</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-fail-to-create-a-uniqueness-constraint-due-to-conflicting-nodes" class="discrete">Creating a constraint when there exist conflicting nodes will fail</h3>
<div class="exampleblock">
<div class="title">Example 8. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a property uniqueness constraint on the property <code>title</code> on nodes with the <code>Book</code> label, when there are two nodes with the same <code>title</code>:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT book_title FOR (book:Book) REQUIRE book.title IS UNIQUE</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because it is in conflict with the existing graph.
Either use <a href="../../indexes-for-search-performance/" class="xref page">Indexes for search performance</a> instead, or remove/correct the offending nodes and then re-apply the constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Unable to create Constraint( name='book_title', type='UNIQUENESS', schema=(:Book {title}) ):
Both Node(0) and Node(1) have the label `Book` and property `title` = 'Moby Dick'</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The constraint type will be updated to say <code>NODE PROPERTY UNIQUENESS</code> in Neo4j version 6.0.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>The constraint creation fails on the first offending nodes that are found.
This does not guarantee that there are no other offending nodes in the graph.
Therefore, all the data should be checked and cleaned up before re-attempting the constraint creation.</p>
</div>
<div class="paragraph">
<p>This is an example <code>MATCH</code> query to find all offending nodes with the non-unique property values for the constraint above:</p>
</div>
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (book1:Book), (book2:Book)
WHERE book1.title = book2.title AND NOT book1 = book2
RETURN book1, book2</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="constraints-examples-relationship-uniqueness"><a class="anchor" href="#constraints-examples-relationship-uniqueness"></a>Relationship property uniqueness constraints</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>This feature was introduced in Neo4j 5.7.</em></p>
</div>
<div class="paragraph">
<p>A relationship property uniqueness constraint ensures that certain relationships have a set of specified properties whose combined value is unique when all properties exist on the relationship.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#constraints-create-a-relationship-uniqueness-constraints">Create a relationship property uniqueness constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-uniqueness-constraints-if-not-exist">Handling existing constraints when creating a constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-uniqueness-constraints-with-index-provider">Specifying an index provider when creating a constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-an-already-existing-relationship-uniqueness-constraint">Creating an already existing constraint will fail</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-uniqueness-constraint-on-same-schema-as-existing-index">Creating a constraint on the same schema as an existing index will fail</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-that-complies-with-a-uniqueness-constraint">Creating a relationship that complies with an existing constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-that-violates-a-uniqueness-constraint">Creating a relationship that violates an existing constraint will fail</a></p>
</li>
<li>
<p><a href="#constraints-fail-to-create-a-uniqueness-constraint-due-to-conflicting-relationships">Creating a constraint when there exist conflicting relationships will fail</a></p>
</li>
</ul>
</div>
<h3 id="constraints-create-a-relationship-uniqueness-constraints" class="discrete">Create a relationship property uniqueness constraint</h3>
<div class="paragraph">
<p>When creating a property uniqueness constraint, it is recommended to provide a constraint name.</p>
</div>
<div class="exampleblock">
<div class="title">Example 9. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT sequels
FOR ()-[sequel:SEQUEL_OF]-() REQUIRE (sequel.order, sequel.seriesTitle) IS UNIQUE</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 constraint.</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The detailed statistics view currently says <code>Relationship uniqueness constraints added: 1</code>.
It will be updated to say <code>Relationship property uniqueness constraints added: 1</code> in Neo4j version 6.0.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-uniqueness-constraints-if-not-exist" class="discrete">Handling existing constraints when creating a constraint</h3>
<div class="paragraph">
<p>Creating an already existing constraint will fail.
To avoid such an error, <code>IF NOT EXISTS</code> can be added to the <code>CREATE</code> command.
This will ensure that no error is thrown and that no constraint is created if any other constraint with the given name, or another relationship property uniqueness constraint on the same schema, already exists.</p>
</div>
<div class="exampleblock">
<div class="title">Example 10. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT sequels IF NOT EXISTS
FOR ()-[sequel:SEQUEL_OF]-() REQUIRE (sequel.order) IS UNIQUE</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming a constraint with the name <code>sequels</code> already exists:</p>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>(no changes, no records)</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The detailed statistics view currently says <code>Relationship uniqueness constraints added: 1</code>.
It will be updated to say <code>Relationship property uniqueness constraints added: 1</code> in Neo4j version 6.0.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-uniqueness-constraints-with-index-provider" class="discrete">Specifying an index provider when creating a constraint</h3>
<div class="paragraph">
<p>To create a property uniqueness constraint with a specific index provider for the backing index, the <code>OPTIONS</code> clause is used.</p>
</div>
<div class="paragraph">
<p>The index type of the backing index is set with the <code>indexProvider</code> option.</p>
</div>
<div class="paragraph">
<p>The only valid value for the index provider is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>range-1.0</code> <span class="label label--default">Default</span></p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 11. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT rel_constraint_with_options
FOR ()-[sequel:SEQUEL_OF]-() REQUIRE (sequel.order, sequel.seriesTitle, sequel.number) IS UNIQUE
OPTIONS {
  indexProvider: 'range-1.0'
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 constraint.</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The detailed statistics view currently says <code>Relationship uniqueness constraints added: 1</code>.
It will be updated to say <code>Relationship property uniqueness constraints added: 1</code> in Neo4j version 6.0.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>There are no valid index configuration values for the constraint-backing range indexes.</p>
</div>
<h3 id="constraints-create-an-already-existing-relationship-uniqueness-constraint" class="discrete">Creating an already existing constraint will fail</h3>
<div class="exampleblock">
<div class="title">Example 12. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a property uniqueness constraint on the properties <code>order</code> and <code>seriesTitle</code> on relationships with the <code>SEQUEL_OF</code> relationship type, when that constraint already exists:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT sequel_order_seriestitle FOR ()-[sequel:SEQUEL_OF]-() REQUIRE (sequel.order, sequel.seriesTitle) IS UNIQUE</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because it already exists.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Constraint already exists:
Constraint( id=13, name='sequels', type='RELATIONSHIP UNIQUENESS', schema=()-[:SEQUEL_OF {order, seriesTitle}]-(), ownedIndex=12 )</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The constraint type will be updated to say <code>RELATIONSHIP PROPERTY UNIQUENESS</code> in Neo4j version 6.0.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-uniqueness-constraint-on-same-schema-as-existing-index" class="discrete">Creating a constraint on the same schema as an existing index will fail</h3>
<div class="exampleblock">
<div class="title">Example 13. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a property uniqueness constraint on the property <code>order</code> on relationships with the <code>SEQUEL_OF</code> relationship type, when an index already exists on that relationship type and property combination:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT sequel_series_title FOR ()-[sequel:SEQUEL_OF]-() REQUIRE (sequel.order) IS UNIQUE</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because there already exists an index covering that schema.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">There already exists an index ()-[:SEQUEL_OF {order}]-().
A constraint cannot be created until the index has been dropped.</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-that-complies-with-a-uniqueness-constraint" class="discrete">Creating a relationship that complies with an existing constraint</h3>
<div class="exampleblock">
<div class="title">Example 14. CREATE RELATIONSHIP</div>
<div class="content">
<div class="paragraph">
<p>Create a <code>SEQUEL_OF</code> relationship with values for properties <code>order</code> and <code>seriesTitle</code> that are not already in the graph:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE (:Book {title: 'Spirit Walker'})-[:SEQUEL_OF {order: 1, seriesTitle: 'Chronicles of Ancient Darkness'}]-&gt;(:Book {title: 'Wolf Brother'})</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 2 labels, created 2 nodes, set 4 properties, created 1 relationship.</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-that-violates-a-uniqueness-constraint" class="discrete">Creating a relationship that violates an existing constraint will fail</h3>
<div class="exampleblock">
<div class="title">Example 15. CREATE RELATIONSHIP</div>
<div class="content">
<div class="paragraph">
<p>Create a <code>SEQUEL_OF</code> relationship with values for properties <code>order</code> and <code>seriesTitle</code> that are already used in the graph:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (wolfBrother:Book {title: 'Wolf Brother'}), (spiritWalker:Book {title: 'Spirit Walker'})
CREATE (spiritWalker)-[:SEQUEL_OF {order: 1, seriesTitle: 'Chronicles of Ancient Darkness'}]-&gt;(wolfBrother)</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the relationship is not created because the combination of the <code>order</code> and <code>seriesTitle</code> properties are in conflict with an existing constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Relationship(0) already exists with type `SEQUEL_OF` and properties `order` = 1, `seriesTitle` = 'Chronicles of Ancient Darkness'</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-fail-to-create-a-uniqueness-constraint-due-to-conflicting-relationships" class="discrete">Creating a constraint when there exist conflicting relationships will fail</h3>
<div class="exampleblock">
<div class="title">Example 16. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a property uniqueness constraint on the property <code>seriesTitle</code> on relationships with the <code>SEQUEL_OF</code> relationship type, when two relationships with the same <code>seriesTitle</code> already exist:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT series_title FOR ()-[sequel:SEQUEL_OF]-() REQUIRE (sequel.seriesTitle) IS UNIQUE</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because it is in conflict with the existing graph.
Either use <a href="../../indexes-for-search-performance/" class="xref page">Indexes for search performance</a> instead, or remove/correct the offending relationships and then re-apply the constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Unable to create Constraint( name='series_title', type='RELATIONSHIP UNIQUENESS', schema=()-[:SEQUEL_OF {seriesTitle}]-() ):
Both Relationship(0) and Relationship(1) have the type `SEQUEL_OF` and property `seriesTitle` = 'Chronicles of Ancient Darkness'</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The constraint creation fails on the first offending relationships that are found.
This does not guarantee that there are no other offending relationships in the graph.
Therefore, all the data should be checked and cleaned up before re-attempting the constraint creation.</p>
</div>
<div class="paragraph">
<p>This is an example <code>MATCH</code> query to find all offending relationships for the constraint above:</p>
</div>
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH ()-[knows1:KNOWS]-&gt;(), ()-[knows2:KNOWS]-&gt;()
WHERE knows1.level = knows2.level AND NOT knows1 = knows2
RETURN knows1, knows2</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1 enterprise-edition">
<h2 id="constraints-examples-node-property-existence"><a class="anchor" href="#constraints-examples-node-property-existence"></a>Node property existence constraints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A node property existence constraint ensures that certain nodes have a specified property.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#constraints-create-a-node-property-existence-constraint">Create a node property existence constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-property-existence-constraint-if-not-exist">Handling existing constraints when creating a constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-an-already-existing-node-property-existence-constraint">Creating an already existing constraint will fail</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-that-complies-with-a-property-existence-constraint">Creating a node that complies with an existing constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-that-violates-a-property-existence-constraint">Creating a node that violates an existing constraint will fail</a></p>
</li>
<li>
<p><a href="#constraints-removing-an-existence-constrained-node-property">Removing an existence constrained node property will fail</a></p>
</li>
<li>
<p><a href="#constraints-fail-to-create-a-property-existence-constraint-due-to-existing-node">Creating a constraint when there exist conflicting nodes will fail</a></p>
</li>
</ul>
</div>
<h3 id="constraints-create-a-node-property-existence-constraint" class="discrete">Create a node property existence constraint</h3>
<div class="paragraph">
<p>When creating a node property existence constraint, it is recommended to provide a constraint name.</p>
</div>
<div class="exampleblock">
<div class="title">Example 17. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT author_name
FOR (author:Author) REQUIRE author.name IS NOT NULL</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 constraint.</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The detailed statistics view for property existence constraints, <code>Property existence constraints added:  1</code>, will be split between nodes and relationships in Neo4j version 6.0.
For the node property existence constraints, they will say <code>Node property existence constraints added: 1</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-property-existence-constraint-if-not-exist" class="discrete">Handling existing constraints when creating a constraint</h3>
<div class="paragraph">
<p>Creating an already existing constraint will fail.
To avoid such an error, <code>IF NOT EXISTS</code> can be added to the <code>CREATE</code> command.
This will ensure that no error is thrown and that no constraint is created if any other constraint with the given name, or another node property existence constraint on the same schema, already exists.</p>
</div>
<div class="exampleblock">
<div class="title">Example 18. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT author_pseudonym IF NOT EXISTS
FOR (author:Author) REQUIRE author.pseudonym IS NOT NULL</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming a constraint with the name <code>author_pseudonym</code> already exists:</p>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>(no changes, no records)</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-an-already-existing-node-property-existence-constraint" class="discrete">Creating an already existing constraint will fail</h3>
<div class="exampleblock">
<div class="title">Example 19. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a node property existence constraint on the property <code>name</code> on nodes with the <code>Author</code> label, when that constraint already exists:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT author_name
FOR (author:Author) REQUIRE author.name IS NOT NULL</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because it already exists.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">An equivalent constraint already exists, 'Constraint( id=10, name='author_name', type='NODE PROPERTY EXISTENCE', schema=(:Author {name}) )'.</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-that-complies-with-a-property-existence-constraint" class="discrete">Creating a node that complies with an existing constraint</h3>
<div class="exampleblock">
<div class="title">Example 20. CREATE NODE</div>
<div class="content">
<div class="paragraph">
<p>Create an <code>Author</code> node with a <code>name</code> property:</p>
</div>
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE (author:Author {name:'Virginia Woolf'})</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 label, created 1 node, set 1 properties</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-that-violates-a-property-existence-constraint" class="discrete">Creating a node that violates an existing constraint will fail</h3>
<div class="exampleblock">
<div class="title">Example 21. CREATE NODE</div>
<div class="content">
<div class="paragraph">
<p>Create an <code>Author</code> node without a <code>name</code> property, given a property existence constraint on <code>:Author(name)</code>:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE (author:Author)</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the node is not created because it is missing the <code>name</code> property which is in conflict with an existing constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Node(0) with label `Author` must have the property `name`</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-removing-an-existence-constrained-node-property" class="discrete">Removing an existence constrained node property will fail</h3>
<div class="exampleblock">
<div class="title">Example 22. REMOVE PROPERTY</div>
<div class="content">
<div class="paragraph">
<p>Remove the <code>name</code> property from an existing node <code>Author</code>, given a property existence constraint on <code>:Author(name)</code>:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (author:Author {name: 'Virginia Woolf'})
REMOVE author.name</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the property is not removed because it is in conflict with an existing constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Node(0) with label `Author` must have the property `name`</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-fail-to-create-a-property-existence-constraint-due-to-existing-node" class="discrete">Creating a constraint when there exist conflicting nodes will fail</h3>
<div class="exampleblock">
<div class="title">Example 23. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a constraint on the property <code>nationality</code> on nodes with the <code>Author</code> label, when there already exists a node without a <code>nationality</code> property:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT author_nationality FOR (author:Author) REQUIRE author.nationality IS NOT NULL</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because it is in conflict with the existing graph.
Remove or correct the offending nodes and then re-apply the constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Unable to create Constraint( type='NODE PROPERTY EXISTENCE', schema=(:Author {nationality}) ):
Node(0) with label `Author` must have the property `nationality`</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The constraint creation fails on the first offending node that is found.
This does not guarantee that there are no other offending nodes in the graph.
Therefore, all the data should be checked and cleaned up before re-attempting the constraint creation.</p>
</div>
<div class="paragraph">
<p>This is an example <code>MATCH</code> query to find all offending nodes missing the property for the constraint above:</p>
</div>
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (author:Author)
WHERE author.nationality IS NULL
RETURN author</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1 enterprise-edition">
<h2 id="constraints-examples-relationship-property-existence"><a class="anchor" href="#constraints-examples-relationship-property-existence"></a>Relationship property existence constraints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A relationship property existence constraint ensures that certain relationships have a certain property.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#constraints-create-a-relationship-property-existence-constraint">Create a relationship property existence constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-property-existence-constraint-if-not-exist">Handling existing constraints when creating a constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-an-already-existing-relationship-property-existence-constraint">Creating an already existing constraint will fail</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-that-complies-with-a-property-existence-constraint">Creating a relationship that complies with an existing constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-that-violates-a-property-existence-constraint">Creating a relationship that violates an existing constraint will fail</a></p>
</li>
<li>
<p><a href="#constraints-removing-an-existence-constrained-relationship-property">Removing an existence constrained relationship property will fail</a></p>
</li>
<li>
<p><a href="#constraints-fail-to-create-a-property-existence-constraint-due-to-existing-relationship">Creating a constraint when there exist conflicting relationships will fail</a></p>
</li>
</ul>
</div>
<h3 id="constraints-create-a-relationship-property-existence-constraint" class="discrete">Create a relationship property existence constraint</h3>
<div class="paragraph">
<p>When creating a relationship property existence constraint, it is recommended to provide a constraint name.</p>
</div>
<div class="exampleblock">
<div class="title">Example 24. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT wrote_year
FOR ()-[wrote:WROTE]-() REQUIRE wrote.year IS NOT NULL</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 constraint.</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The detailed statistics view for property existence constraints, <code>Property existence constraints added:  1</code>, will be split between nodes and relationships in Neo4j version 6.0.
For the relationship property existence constraints, they will say <code>Relationship property existence constraints added: 1</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-property-existence-constraint-if-not-exist" class="discrete">Handling existing constraints when creating a constraint</h3>
<div class="paragraph">
<p>Creating an already existing constraint will fail.
To avoid such an error, <code>IF NOT EXISTS</code> can be added to the <code>CREATE</code> command.
This will ensure that no error is thrown and that no constraint is created if any other constraint with the given name, or another relationship property existence constraint on the same schema, already exists.</p>
</div>
<div class="exampleblock">
<div class="title">Example 25. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT wrote_year IF NOT EXISTS
FOR ()-[wrote:WROTE]-() REQUIRE wrote.year IS NOT NULL</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming that such a constraint already exists:</p>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>(no changes, no records)</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-an-already-existing-relationship-property-existence-constraint" class="discrete">Creating an already existing constraint will fail</h3>
<div class="exampleblock">
<div class="title">Example 26. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a named relationship property existence constraint on the property <code>locations</code> on relationships with the <code>WROTE</code> relationship type, when a constraint with the given name already exists:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT wrote_locations
FOR ()-[wrote:WROTE]-() REQUIRE wrote.locations IS NOT NULL</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because there already exists a constraint with the given name.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">There already exists a constraint called 'wrote_locations'.</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-that-complies-with-a-property-existence-constraint" class="discrete">Creating a relationship that complies with an existing constraint</h3>
<div class="exampleblock">
<div class="title">Example 27. CREATE RELATIONSHIP</div>
<div class="content">
<div class="paragraph">
<p>Create a <code>WROTE</code> relationship with a <code>year</code> and <code>location</code> property, given property existence constraints on <code>:WROTE(year)</code> and <code>:WROTE(location)</code>:</p>
</div>
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE (author:Author {name: 'Emily Brontë'})-[wrote:WROTE {year: 1847, location: 'Haworth, United Kingdom'}]-&gt;(book:Book {title:'Wuthering Heights', isbn: 9789186579296})</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 2 labels, created 2 nodes, set 5 properties, created 1 relationship</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-that-violates-a-property-existence-constraint" class="discrete">Creating a relationship that violates an existing constraint will fail</h3>
<div class="exampleblock">
<div class="title">Example 28. CREATE RELATIONSHIP</div>
<div class="content">
<div class="paragraph">
<p>Create a <code>WROTE</code> relationship without a <code>location</code> property, given a property existence constraint <code>:WROTE(location)</code>:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE (author:Author {name: 'Charlotte Brontë'})-[wrote:WROTE {year: 1847}]-&gt;(book:Book {title: 'Jane Eyre', isbn:9780194241762})</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the relationship is not created because it is missing the <code>location</code> property which is in conflict with an existing constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Relationship(0) with type `WROTE` must have the property `location`</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-removing-an-existence-constrained-relationship-property" class="discrete">Removing an existence constrained relationship property will fail</h3>
<div class="exampleblock">
<div class="title">Example 29. REMOVE PROPERTY</div>
<div class="content">
<div class="paragraph">
<p>Remove the <code>location</code> property from an existing relationship of relationship type <code>WROTE</code>, given a property existence constraint <code>:WROTE(location)</code>:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (author:Author)-[wrote:WROTE]-&gt;(book:Book) REMOVE wrote.location</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the property is not removed because it is in conflict with an existing constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Relationship(0) with type `WROTE` must have the property `location`</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-fail-to-create-a-property-existence-constraint-due-to-existing-relationship" class="discrete">Creating a constraint when there exist conflicting relationships will fail</h3>
<div class="exampleblock">
<div class="title">Example 30. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a constraint on the property <code>language</code> on relationships with the <code>WROTE</code> relationship type, when there already exists a relationship without a property named <code>language</code>:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT wrote_language FOR ()-[wrote:WROTE]-() REQUIRE wrote.language IS NOT NULL</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because it is in conflict with the existing graph.
Remove or correct the offending relationships and then re-apply the constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Unable to create Constraint( type='RELATIONSHIP PROPERTY EXISTENCE', schema=()-[:WROTE {language}]-() ):
Relationship(0) with type `WROTE` must have the property `language`</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The constraint creation fails on the first offending relationship that is found.
This does not guarantee that there are no other offending relationships in the graph.
Therefore, all the data should be checked and cleaned up before re-attempting the constraint creation.</p>
</div>
<div class="paragraph">
<p>This is an example <code>MATCH</code> query to find all offending relationships missing the property for the constraint above:</p>
</div>
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH ()-[wrote:WROTE]-()
WHERE wrote.language IS NULL
RETURN wrote</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1 enterprise-edition">
<h2 id="constraints-examples-node-property-type"><a class="anchor" href="#constraints-examples-node-property-type"></a>Node property type constraints</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>This feature was introduced in Neo4j 5.9.</em></p>
</div>
<div class="paragraph">
<p>A node property type constraint ensures that certain nodes have a property of the required property type when the property exists on the node.</p>
</div>
<div class="paragraph">
<p>The allowed property types for the constraints are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BOOLEAN</code></p>
</li>
<li>
<p><code>STRING</code></p>
</li>
<li>
<p><code>INTEGER</code></p>
</li>
<li>
<p><code>FLOAT</code></p>
</li>
<li>
<p><code>DATE</code></p>
</li>
<li>
<p><code>LOCAL TIME</code></p>
</li>
<li>
<p><code>ZONED TIME</code></p>
</li>
<li>
<p><code>LOCAL DATETIME</code></p>
</li>
<li>
<p><code>ZONED DATETIME</code></p>
</li>
<li>
<p><code>DURATION</code></p>
</li>
<li>
<p><code>POINT</code></p>
</li>
<li>
<p><code>LIST&lt;BOOLEAN NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;STRING NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;INTEGER NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;FLOAT NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;DATE NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;LOCAL TIME NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;ZONED TIME NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;LOCAL DATETIME NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;ZONED DATETIME NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;DURATION NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;POINT NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p>Any closed dynamic union of the above types, e.g. <code>INTEGER | FLOAT | STRING</code>. <span class="label label--new">Introduced in 5.11</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For all available Cypher<sup>&reg;</sup> types, see the section on <a href="../../values-and-types/property-structural-constructed/#types-synonyms" class="xref page">types and their synonyms</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#constraints-create-a-node-property-type-constraint">Create a node property type constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-property-type-constraint-if-not-exist">Handling existing constraints when creating a constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-an-already-existing-node-property-type-constraint">Creating an already existing constraint will fail</a></p>
</li>
<li>
<p><a href="#constraints-create-a-different-than-existing-node-property-type-constraint">Creating a constraint when there is an existing constraint with a different property type will fail</a></p>
</li>
<li>
<p><a href="#constraints-create-node-property-type-constraints-on-invalid-types">Creating constraints on invalid types will fail</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-that-complies-with-a-property-type-constraint">Creating a node that complies with an existing constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-that-violates-a-property-type-constraint">Creating a node that violates an existing constraint will fail</a></p>
</li>
<li>
<p><a href="#constraints-fail-to-create-a-property-type-constraint-due-to-existing-node">Creating a constraint when there exist conflicting nodes will fail</a></p>
</li>
</ul>
</div>
<h3 id="constraints-create-a-node-property-type-constraint" class="discrete">Create a node property type constraint</h3>
<div class="paragraph">
<p>When creating a node property type constraint, it is recommended to provide a constraint name.</p>
</div>
<div class="exampleblock">
<div class="title">Example 31. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT movie_title
FOR (movie:Movie) REQUIRE movie.title IS :: STRING</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 constraint.</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-property-type-constraint-union" class="discrete">Create a node property type constraint with a union type</h3>
<div class="paragraph">
<p><em>This feature was introduced in Neo4j 5.11.</em></p>
</div>
<div class="paragraph">
<p>A closed dynamic union allows a node property to maintain some type flexibility whilst preventing unexpected values from being stored.</p>
</div>
<div class="exampleblock">
<div class="title">Example 32. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT movie_tagline
FOR (movie:Movie) REQUIRE movie.tagline IS :: STRING | LIST&lt;STRING NOT NULL&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 constraint.</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-property-type-constraint-if-not-exist" class="discrete">Handling existing constraints when creating a constraint</h3>
<div class="paragraph">
<p>Creating an already existing constraint will fail.
To avoid such an error, <code>IF NOT EXISTS</code> can be added to the <code>CREATE</code> command.
This will ensure that no error is thrown and that no constraint is created if any other constraint with the given name, or another node property type constraint on the same schema and property type, already exists.</p>
</div>
<div class="exampleblock">
<div class="title">Example 33. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT movie_titles IF NOT EXISTS
FOR (movie:Movie) REQUIRE movie.title :: STRING</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming a node property type constraint on the label <code>Movie</code> which restricts the property <code>title</code> to string values already exists:</p>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>(no changes, no records)</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-an-already-existing-node-property-type-constraint" class="discrete">Creating an already existing constraint will fail</h3>
<div class="exampleblock">
<div class="title">Example 34. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a node property type constraint restricting the property <code>title</code> to string values on nodes with the <code>Movie</code> label, when that constraint already exists:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT movies
FOR (movie:Movie) REQUIRE movie.title IS TYPED STRING</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because it already exists.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Constraint already exists: Constraint( id=22, name='movie_title', type='NODE PROPERTY TYPE', schema=(:Movie {title}), propertyType=STRING )</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-different-than-existing-node-property-type-constraint" class="discrete">Creating a constraint when there is an existing constraint with a different property type will fail</h3>
<div class="exampleblock">
<div class="title">Example 35. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a node property type constraint restricting the property <code>seriesOrder</code> to float values on nodes with the <code>Movie</code> label, when a node property type constraint restricting the property <code>seriesOrder</code> to integer values already exists:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT order
FOR (movie:Movie) REQUIRE movie.seriesOrder IS :: FLOAT</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because there exists a conflicting constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Constraint already exists: Constraint( id=23, name='seriesOrder', type='NODE PROPERTY TYPE', schema=(:Movie {seriesOrder}), propertyType=INTEGER )</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-node-property-type-constraints-on-invalid-types" class="discrete">Creating constraints on invalid types will fail</h3>
<div class="exampleblock">
<div class="title">Example 36. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a node property type constraint restricting the property <code>imdbScore</code> to map values on nodes with the <code>Movie</code> label:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT score
FOR (movie:Movie) REQUIRE movie.imdbScore IS :: MAP</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because values of type <code>MAP</code> cannot be stored in properties and therefore are not permitted in property type constraints.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Failed to create node property type constraint: Invalid property type `MAP`.</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 37. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a node property type constraint restricting the property <code>imdbScore</code> to list of nullable float values on nodes with the <code>Movie</code> label:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT score
FOR (movie:Movie) REQUIRE movie.imdbScore IS :: LIST&lt;FLOAT&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because the inner type of list types cannot be nullable.
The correct type to use for the constraint is <code>LIST&lt;FLOAT NOT NULL&gt;</code> because <code>null</code> values cannot be stored as part of a list.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Failed to create node property type constraint: Invalid property type `LIST&lt;FLOAT&gt;`. Lists cannot have nullable inner types.</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 38. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a node property type constraint restricting the property <code>imdbScore</code> to list of lists of float values on nodes with the <code>Movie</code> label:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT score
FOR (movie:Movie) REQUIRE movie.imdbScore IS :: LIST&lt;LIST&lt;FLOAT NOT NULL&gt;&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because the inner type of list types cannot be other lists.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Failed to create node property type constraint: Invalid property type `LIST&lt;LIST&lt;FLOAT NOT NULL&gt;&gt;`. Lists cannot have lists as an inner type.</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-that-complies-with-a-property-type-constraint" class="discrete">Creating a node that complies with an existing constraint</h3>
<div class="exampleblock">
<div class="title">Example 39. CREATE NODE</div>
<div class="content">
<div class="paragraph">
<p>Create an <code>Movie</code> node with a string <code>title</code> property:</p>
</div>
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE (movie:Movie {title:'Iron Man'})</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 label, created 1 node, set 1 properties</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-that-violates-a-property-type-constraint" class="discrete">Creating a node that violates an existing constraint will fail</h3>
<div class="exampleblock">
<div class="title">Example 40. CREATE NODE</div>
<div class="content">
<div class="paragraph">
<p>Create a <code>Movie</code> node with an integer <code>title</code> property, given a property type constraint on the label <code>Movie</code> restricting the <code>title</code> property to string values:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE (movie:Movie {title: 123})</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the node is not created because the <code>title</code> property is in conflict with an existing constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Node(0) with label `Movie` has property `title` of wrong type `Long`. Allowed types: STRING</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-fail-to-create-a-property-type-constraint-due-to-existing-node" class="discrete">Creating a constraint when there exist conflicting nodes will fail</h3>
<div class="exampleblock">
<div class="title">Example 41. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a constraint restricting the property <code>franchise</code> to string values on nodes with the <code>Movie</code> label, when there already exists a node with a boolean <code>franchise</code> property:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT movie_franchise FOR (movie:Movie) REQUIRE movie.franchise IS :: STRING</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because it is in conflict with the existing graph.
Remove or correct the offending nodes and then re-apply the constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Unable to create Constraint( name='movie_franchise', type='NODE PROPERTY TYPE', schema=(:Movie {franchise}), propertyType=STRING ):
Node(0) with label `Movie` has property `franchise` of wrong type `Boolean`. Allowed types: STRING</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The constraint creation fails on the first offending node that is found.
This does not guarantee that there are no other offending nodes in the graph.
Therefore, all the data should be checked and cleaned up before re-attempting the constraint creation.</p>
</div>
<div class="paragraph">
<p>This is an example <code>MATCH</code> query to find all offending nodes with the wrong property type for the constraint above:</p>
</div>
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (movie:Movie)
WHERE movie.franchise IS NOT :: STRING
RETURN movie</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1 enterprise-edition">
<h2 id="constraints-examples-relationship-property-type"><a class="anchor" href="#constraints-examples-relationship-property-type"></a>Relationship property type constraints</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>This feature was introduced in Neo4j 5.9.</em></p>
</div>
<div class="paragraph">
<p>A relationship property type constraint ensures that certain relationships have a property of the required property type when the property exists on the relationhip.</p>
</div>
<div class="paragraph">
<p>The allowed property types for the constraints is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BOOLEAN</code></p>
</li>
<li>
<p><code>STRING</code></p>
</li>
<li>
<p><code>INTEGER</code></p>
</li>
<li>
<p><code>FLOAT</code></p>
</li>
<li>
<p><code>DATE</code></p>
</li>
<li>
<p><code>LOCAL TIME</code></p>
</li>
<li>
<p><code>ZONED TIME</code></p>
</li>
<li>
<p><code>LOCAL DATETIME</code></p>
</li>
<li>
<p><code>ZONED DATETIME</code></p>
</li>
<li>
<p><code>DURATION</code></p>
</li>
<li>
<p><code>POINT</code></p>
</li>
<li>
<p><code>LIST&lt;BOOLEAN NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;STRING NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;INTEGER NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;FLOAT NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;DATE NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;LOCAL TIME NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;ZONED TIME NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;LOCAL DATETIME NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;ZONED DATETIME NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;DURATION NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p><code>LIST&lt;POINT NOT NULL&gt;</code> <span class="label label--new">Introduced in 5.10</span></p>
</li>
<li>
<p>Any closed dynamic union of the above types, e.g. <code>INTEGER | FLOAT | STRING</code>. <span class="label label--new">Introduced in 5.11</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For all available Cypher types, see the section on <a href="../../values-and-types/property-structural-constructed/#types-synonyms" class="xref page">types and their synonyms</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#constraints-create-a-relationship-property-type-constraint">Create a relationship property type constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-property-type-constraint-if-not-exist">Handling existing constraints when creating a constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-an-already-existing-relationship-property-type-constraint">Creating an already existing constraint will fail</a></p>
</li>
<li>
<p><a href="#constraints-create-a-different-than-existing-relationship-property-type-constraint">Creating a constraint when there is an existing constraint with a different property type will fail</a></p>
</li>
<li>
<p><a href="#constraints-create-relationship-property-type-constraints-on-invalid-types">Creating constraints on invalid types will fail</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-that-complies-with-a-property-type-constraint">Creating a relationship that complies with an existing constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-that-violates-a-property-type-constraint">Creating a relationship that violates an existing constraint will fail</a></p>
</li>
<li>
<p><a href="#constraints-fail-to-create-a-property-type-constraint-due-to-existing-relationship">Creating a constraint when there exist conflicting relationships will fail</a></p>
</li>
</ul>
</div>
<h3 id="constraints-create-a-relationship-property-type-constraint" class="discrete">Create a relationship property type constraint</h3>
<div class="paragraph">
<p>When creating a relationship property type constraint, it is recommended to provide a constraint name.</p>
</div>
<div class="exampleblock">
<div class="title">Example 42. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT part_of
FOR ()-[part:PART_OF]-() REQUIRE part.order IS :: INTEGER</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 constraint.</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-property-type-constraint-union" class="discrete">Create a relationship property type constraint with a union type</h3>
<div class="paragraph">
<p><em>This feature was introduced in Neo4j 5.11.</em></p>
</div>
<div class="paragraph">
<p>A closed dynamic union allows a relationship property to maintain some type flexibility whilst preventing unexpected values from being stored.</p>
</div>
<div class="exampleblock">
<div class="title">Example 43. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT part_of_tags
FOR ()-[part:PART_OF]-() REQUIRE part.tags IS :: STRING | LIST&lt;STRING NOT NULL&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 constraint.</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-property-type-constraint-if-not-exist" class="discrete">Handling existing constraints when creating a constraint</h3>
<div class="paragraph">
<p>Creating an already existing constraint will fail.
To avoid such an error, <code>IF NOT EXISTS</code> can be added to the <code>CREATE</code> command.
This will ensure that no error is thrown and that no constraint is created if any other constraint with the given name, or another relationship property type constraint on the same schema and property type, already exists.</p>
</div>
<div class="exampleblock">
<div class="title">Example 44. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT part_of IF NOT EXISTS
FOR ()-[part:PART_OF]-() REQUIRE part.order IS TYPED INTEGER</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming that such a constraint already exists:</p>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>(no changes, no records)</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-an-already-existing-relationship-property-type-constraint" class="discrete">Creating an already existing constraint will fail</h3>
<div class="exampleblock">
<div class="title">Example 45. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a relationship property type constraint restricting the property <code>order</code> to integer values on relationships with the <code>PART_OF</code> relationship type, when that constraint already exists:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT belongs_to
FOR ()-[part:PART_OF]-() REQUIRE part.order :: INTEGER</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because it already exists (but with a different name).</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Constraint already exists: Constraint( id=24, name='part_of', type='RELATIONSHIP PROPERTY TYPE', schema=()-[:PART_OF {order}]-(), propertyType=INTEGER )</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-different-than-existing-relationship-property-type-constraint" class="discrete">Creating a constraint when there is an existing constraint with a different property type will fail</h3>
<div class="exampleblock">
<div class="title">Example 46. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a relationship property type constraint restricting the property <code>order</code> to float values on relationships with the <code>PART_OF</code> relationship type, when a relationship property type constraint restricting the property <code>order</code> to integer values already exists:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT order
FOR ()-[part:PART_OF]-() REQUIRE part.order IS :: FLOAT</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because there exists a conflicting constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Constraint already exists: Constraint( id=24, name='part_of', type='RELATIONSHIP PROPERTY TYPE', schema=()-[:PART_OF {order}]-(), propertyType=INTEGER )</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-relationship-property-type-constraints-on-invalid-types" class="discrete">Creating constraints on invalid types will fail</h3>
<div class="exampleblock">
<div class="title">Example 47. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a relationship property type constraint restricting the property <code>releaseOrder</code> to integer values excluding <code>null</code> on relationships with the <code>PART_OF</code> relationship type:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT score
FOR ()-[part:PART_OF]-() REQUIRE part.releaseOrder IS :: INTEGER NOT NULL</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because excluding <code>null</code> is not allowed in property type constraints.
To also ensure that the property exists (is not <code>null</code>), add an existence constraint on the property.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Failed to create relationship property type constraint: Invalid property type `INTEGER NOT NULL`.</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 48. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a relationship property type constraint restricting the property <code>releaseOrder</code> to list of nullable integer values on relationships with the <code>PART_OF</code> relationship type:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT score
FOR ()-[part:PART_OF]-() REQUIRE part.releaseOrder IS :: LIST&lt;INTEGER&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because the inner type of list types cannot be nullable.
The correct type to use for the constraint is <code>LIST&lt;INTEGER NOT NULL&gt;</code> because <code>null</code> values cannot be stored as part of a list.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Failed to create relationship property type constraint: Invalid property type `LIST&lt;INTEGER&gt;`. Lists cannot have nullable inner types.</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 49. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a relationship property type constraint restricting the property <code>releaseOrder</code> to list of lists of integer values on relationships with the <code>PART_OF</code> relationship type:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT score
FOR ()-[part:PART_OF]-() REQUIRE part.releaseOrder IS :: LIST&lt;LIST&lt;INTEGER NOT NULL&gt;&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because the inner type of list types cannot be other lists.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Failed to create relationship property type constraint: Invalid property type `LIST&lt;LIST&lt;INTEGER NOT NULL&gt;&gt;`. Lists cannot have lists as an inner type.</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-that-complies-with-a-property-type-constraint" class="discrete">Creating a relationship that complies with an existing constraint</h3>
<div class="exampleblock">
<div class="title">Example 50. CREATE RELATIONSHIP</div>
<div class="content">
<div class="paragraph">
<p>Create a <code>PART_OF</code> relationship with an integer <code>order</code> property:</p>
</div>
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (movie:Movie {title:'Iron Man'}), (franchise:Franchise {name:'MCU'})
CREATE (movie)-[part:PART_OF {order: 3}]-&gt;(franchise)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Set 1 property, created 1 relationship</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-that-violates-a-property-type-constraint" class="discrete">Creating a relationship that violates an existing constraint will fail</h3>
<div class="exampleblock">
<div class="title">Example 51. CREATE RELATIONSHIP</div>
<div class="content">
<div class="paragraph">
<p>Create a <code>PART_OF</code> relationship with a string <code>order</code> property, given a property type constraint on the relationship type <code>PART_OF</code> restricting the <code>order</code> property to integer values:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (movie:Movie {title:'Captain America: The First Avenger'}), (franchise:Franchise {name:'MCU'})
CREATE (movie)-[part:PART_OF {order: '1'}]-&gt;(franchise)</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the relationship is not created because the <code>order</code> property is in conflict with an existing constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Relationship(0) with type `PART_OF` has property `order` of wrong type `String`. Allowed types: INTEGER</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-fail-to-create-a-property-type-constraint-due-to-existing-relationship" class="discrete">Creating a constraint when there exist conflicting relationships will fail</h3>
<div class="exampleblock">
<div class="title">Example 52. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a constraint restricting the property <code>releaseOrder</code> to integer values on relationships with the <code>PART_OF</code> relationship type, when there already exists a relationship with a string <code>releaseOrder</code> property:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT release_order
FOR ()-[part:PART_OF]-() REQUIRE part.releaseOrder IS :: INTEGER</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because it is in conflict with the existing graph.
Remove or correct the offending relationships and then re-apply the constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Unable to create Constraint( name='release_order', type='RELATIONSHIP PROPERTY TYPE', schema=()-[:PART_OF {releaseOrder}]-(), propertyType=INTEGER ):
Relationship(0) with type `PART_OF` has property `releaseOrder` of wrong type `String`. Allowed types: INTEGER</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The constraint creation fails on the first offending relationship that is found.
This does not guarantee that there are no other offending relationships in the graph.
Therefore, all the data should be checked and cleaned up before re-attempting the constraint creation.</p>
</div>
<div class="paragraph">
<p>This is an example <code>MATCH</code> query to find all offending relationships with the wrong property type for the constraint above:</p>
</div>
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH ()-[part:PART_OF]-()
WHERE part.releaseOrder IS NOT :: INTEGER
RETURN part</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1 enterprise-edition">
<h2 id="constraints-examples-node-key"><a class="anchor" href="#constraints-examples-node-key"></a>Node key constraints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A node key constraint ensures that certain nodes have a set of specified properties whose combined value is unique and all properties in the set are present.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#constraints-create-a-node-key-constraint">Create a node key constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-key-constraint-if-not-exist">Handling existing constraints when creating a constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-key-constraint-with-index-provider">Specifying an index provider when creating a constraint</a></p>
</li>
<li>
<p><a href="#constraints-node-key-and-uniqueness-constraint-on-the-same-schema">Node key and property uniqueness constraints are not allowed on the same schema</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-key-constraint-with-the-same-name-as-existing-index">Creating a constraint on same name as an existing index will fail</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-that-complies-with-a-node-key-constraint">Creating a node that complies with an existing constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-node-that-violates-a-node-key-constraint">Creating a node that violates an existing constraint will fail</a></p>
</li>
<li>
<p><a href="#constraints-removing-a-node-key-constrained-property">Removing a NODE KEY-constrained property will fail</a></p>
</li>
<li>
<p><a href="#constraints-fail-to-create-a-node-key-constraint-due-to-existing-node">Creating a constraint when there exist conflicting node will fail</a></p>
</li>
</ul>
</div>
<h3 id="constraints-create-a-node-key-constraint" class="discrete">Create a node key constraint</h3>
<div class="paragraph">
<p>When creating a node key constraint, it is recommended to provide a constraint name.</p>
</div>
<div class="exampleblock">
<div class="title">Example 53. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT actor_fullname
FOR (actor:Actor) REQUIRE (actor.firstname, actor.surname) IS NODE KEY</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 constraint.</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-key-constraint-if-not-exist" class="discrete">Handling existing constraints when creating a constraint</h3>
<div class="paragraph">
<p>Creating an already existing constraint will fail.
To avoid such an error, <code>IF NOT EXISTS</code> can be added to the <code>CREATE</code> command.
This will ensure that no error is thrown and that no constraint is created if any other constraint with the given name, or another node key constraint on the same schema, already exists.</p>
</div>
<div class="exampleblock">
<div class="title">Example 54. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT actor_names IF NOT EXISTS
FOR (actor:Actor) REQUIRE (actor.firstname, actor.surname) IS NODE KEY</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming a node key constraint on <code>(:Actor {firstname, surname})</code> already exists:</p>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>(no changes, no records)</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-key-constraint-with-index-provider" class="discrete">Specifying an index provider when creating a constraint</h3>
<div class="paragraph">
<p>To create a node key constraint with a specific index provider for the backing index, the <code>OPTIONS</code> clause is used.</p>
</div>
<div class="paragraph">
<p>The index type of the backing index is set with the <code>indexProvider</code> option.</p>
</div>
<div class="paragraph">
<p>The only valid value for the index provider is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>range-1.0</code> <span class="label label--default">Default</span></p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 55. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT constraint_with_provider
FOR (actor:Actor) REQUIRE (actor.surname) IS NODE KEY
OPTIONS {
  indexProvider: 'range-1.0'
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 constraint.</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>There is no valid index configuration values for the constraint-backing range indexes.</p>
</div>
<h3 id="constraints-node-key-and-uniqueness-constraint-on-the-same-schema" class="discrete">Node key and property uniqueness constraints are not allowed on the same schema</h3>
<div class="exampleblock">
<div class="title">Example 56. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a node key constraint on the properties <code>firstname</code> and <code>age</code> on nodes with the <code>Actor</code> label, when a property uniqueness constraint already exists on the same label and property combination:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT actor_name_age FOR (actor:Actor) REQUIRE (actor.firstname, actor.age) IS NODE KEY</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because there already exist a conflicting constraint on that label and property combination.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Constraint already exists:
Constraint( id=10, name='preExisting_actor_name_age', type='UNIQUENESS', schema=(:Actor {firstname, age}), ownedIndex=9 )</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-key-constraint-with-the-same-name-as-existing-index" class="discrete">Creating a constraint on same name as an existing index will fail</h3>
<div class="exampleblock">
<div class="title">Example 57. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a named node key constraint on the property <code>citizenship</code> on nodes with the <code>Actor</code> label, when an index already exists with the given name:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT citizenship
FOR (actor:Actor) REQUIRE actor.citizenship IS NODE KEY</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because there already exists an index with the given name.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">There already exists an index called 'citizenship'.</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-that-complies-with-a-node-key-constraint" class="discrete">Creating a node that complies with an existing constraint</h3>
<div class="exampleblock">
<div class="title">Example 58. CREATE NODE</div>
<div class="content">
<div class="paragraph">
<p>Create an <code>Actor</code> node with <code>firstname</code> and <code>surname</code> properties:</p>
</div>
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE (actor:Actor {firstname: 'Keanu', surname: 'Reeves'})</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 label, created 1 node, set 2 properties.</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-node-that-violates-a-node-key-constraint" class="discrete">Creating a node that violates an existing constraint will fail</h3>
<div class="exampleblock">
<div class="title">Example 59. CREATE NODE</div>
<div class="content">
<div class="paragraph">
<p>Create an <code>Actor</code> node without a <code>firstname</code> property, given a node key constraint on <code>:Actor(firstname, surname)</code>:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE (actor:Actor {surname: 'Wood'})</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the node is not created because it is missing the <code>firstname</code> property which is in conflict with an existing constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Node(0) with label `Actor` must have the properties (`firstname`, `surname`)</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-removing-a-node-key-constrained-property" class="discrete">Removing a NODE KEY-constrained property will fail</h3>
<div class="exampleblock">
<div class="title">Example 60. REMOVE PROPERTY</div>
<div class="content">
<div class="paragraph">
<p>Remove the <code>firstname</code> property from an existing node <code>Actor</code>, given a <code>NODE KEY</code> constraint on <code>:Actor(firstname, surname)</code>:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (actor:Actor {firstname: 'Keanu', surname: 'Reeves'}) REMOVE actor.firstname</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the property is not removed because it is in conflict with an existing constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Node(0) with label `Actor` must have the properties (`firstname`, `surname`)</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-fail-to-create-a-node-key-constraint-due-to-existing-node" class="discrete">Creating a constraint when there exist conflicting node will fail</h3>
<div class="exampleblock">
<div class="title">Example 61. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a node key constraint on the property <code>born</code> on nodes with the <code>Actor</code> label, when a node without a <code>born</code> property already exists in the graph:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT actor_born FOR (actor:Actor) REQUIRE (actor.born) IS NODE KEY</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the node key constraint cannot be created because it is in conflict with the existing graph.
Either use <a href="../../indexes-for-search-performance/" class="xref page">Indexes for search performance</a> instead, or remove/correct the offending nodes and then re-apply the constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Unable to create Constraint( type='NODE KEY', schema=(:Actor {born}) ):
Node(0) with label `Actor` must have the property `born`</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The constraint creation fails on the first offending nodes that are found.
This does not guarantee that there are no other offending nodes in the graph.
Therefore, all the data should be checked and cleaned up before re-attempting the constraint creation.</p>
</div>
<div class="paragraph">
<p>This is an example <code>MATCH</code> query to find all offending nodes for the constraint above:</p>
</div>
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (actor1:Actor), (actor2:Actor)
WHERE actor1.born = actor2.born AND NOT actor1 = actor2
UNWIND [actor1, actor2] AS actor
RETURN actor, 'non-unique' AS reason

UNION

MATCH (actor:Actor)
WHERE actor.born IS NULL
RETURN actor, 'non-existing' AS reason</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1 enterprise-edition">
<h2 id="constraints-examples-relationship-key"><a class="anchor" href="#constraints-examples-relationship-key"></a>Relationship key constraints</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>This feature was introduced in Neo4j 5.7.</em></p>
</div>
<div class="paragraph">
<p>A relationship key constraint ensures that certain relationships have a set of defined properties whose combined value is unique.
It also ensures that all properties in the set are present.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#constraints-create-a-relationship-key-constraint">Create a relationship key constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-key-constraint-if-not-exist">Handling existing constraints when creating a constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-key-constraint-with-index-provider">Specifying an index provider when creating a constraint</a></p>
</li>
<li>
<p><a href="#constraints-relationship-key-and-uniqueness-constraint-on-the-same-schema">Relationship key and property uniqueness constraints are not allowed on the same schema</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-key-constraint-with-the-same-name-as-existing-index">Creating a constraint on same name as an existing index will fail</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-that-complies-with-a-relationship-key-constraint">Creating a relationship that complies with an existing constraint</a></p>
</li>
<li>
<p><a href="#constraints-create-a-relationship-that-violates-a-relationship-key-constraint">Creating a relationship that violates an existing constraint will fail</a></p>
</li>
<li>
<p><a href="#constraints-removing-a-relationship-key-constrained-property">Removing a RELATIONSHIP KEY-constrained property will fail</a></p>
</li>
<li>
<p><a href="#constraints-fail-to-create-a-relationship-key-constraint-due-to-existing-relationship">Creating a constraint when there exist conflicting relationships will fail</a></p>
</li>
</ul>
</div>
<h3 id="constraints-create-a-relationship-key-constraint" class="discrete">Create a relationship key constraint</h3>
<div class="paragraph">
<p>When creating a relationship key constraint, it is recommended to provide a constraint name.</p>
</div>
<div class="exampleblock">
<div class="title">Example 62. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT knows_since_how
FOR ()-[knows:KNOWS]-() REQUIRE (knows.since, knows.how) IS RELATIONSHIP KEY</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 constraint.</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-key-constraint-if-not-exist" class="discrete">Handling existing constraints when creating a constraint</h3>
<div class="paragraph">
<p>Creating an already existing constraint will fail.
To avoid such an error, <code>IF NOT EXISTS</code> can be added to the <code>CREATE</code> command.
This will ensure that no error is thrown and that no constraint is created if any other constraint with the given name, or another relationship key constraint on the same schema, already exists.</p>
</div>
<div class="exampleblock">
<div class="title">Example 63. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT knows IF NOT EXISTS
FOR ()-[knows:KNOWS]-() REQUIRE (knows.since, knows.how) IS RELATIONSHIP KEY</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming a relationship key constraint on <code>()-[:KNOWS {since, how}]-()</code> already exists:</p>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>(no changes, no records)</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-key-constraint-with-index-provider" class="discrete">Specifying an index provider when creating a constraint</h3>
<div class="paragraph">
<p>To create a relationship key constraint with a specific index provider for the backing index, the <code>OPTIONS</code> clause is used.</p>
</div>
<div class="paragraph">
<p>The index type of the backing index is set with the <code>indexProvider</code> option.</p>
</div>
<div class="paragraph">
<p>The only valid value for the index provider is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>range-1.0</code> <span class="label label--default">Default</span></p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 64. CREATE CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT rel_constraint_with_provider
FOR ()-[knows:KNOWS]-() REQUIRE (knows.since) IS REL KEY
OPTIONS {
  indexProvider: 'range-1.0'
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 1 constraint.</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>There is no valid index configuration values for the constraint-backing range indexes.</p>
</div>
<h3 id="constraints-relationship-key-and-uniqueness-constraint-on-the-same-schema" class="discrete">Relationship key and property uniqueness constraints are not allowed on the same schema</h3>
<div class="exampleblock">
<div class="title">Example 65. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a relationship key constraint on the property <code>how</code> on relationships with the <code>KNOWS</code> relationship type, when a property uniqueness constraint already exists on the same relationship type and property combination:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT knows_how FOR ()-[knows:KNOWS]-() REQUIRE (knows.how) IS REL KEY</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because there already exists a conflicting constraint on that relationship type and property combination.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Constraint already exists:
Constraint( id=34, name='preExisting_how', type='RELATIONSHIP UNIQUENESS', schema=()-[:KNOWS {how}]-(), ownedIndex=33 )</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The constraint type for relationship property uniqueness constraints will be updated to say <code>RELATIONSHIP PROPERTY UNIQUENESS</code> in Neo4j version 6.0.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-key-constraint-with-the-same-name-as-existing-index" class="discrete">Creating a constraint on same name as an existing index will fail</h3>
<div class="exampleblock">
<div class="title">Example 66. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a named relationship key constraint on the property <code>level</code> on relationships with the <code>KNOWS</code> relationship type, when an index already exists with the given name:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT knows
FOR ()-[knows:KNOWS]-() REQUIRE (knows.level) IS REL KEY</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the constraint cannot be created because there already exists an index with the given name.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">There already exists an index called 'knows'.</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-that-complies-with-a-relationship-key-constraint" class="discrete">Creating a relationship that complies with an existing constraint</h3>
<div class="exampleblock">
<div class="title">Example 67. CREATE RELATIONSHIP</div>
<div class="content">
<div class="paragraph">
<p>Create a <code>KNOWS</code> relationship with both <code>since</code> and <code>how</code> properties and a relationship key constraint on <code>:KNOWS(since, how)</code>:</p>
</div>
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE (:Actor {firstname: 'Jensen', surname: 'Ackles'})-[:KNOWS {since: 2008, how: 'coworkers'}]-&gt;(:Actor {firstname: 'Misha', surname: 'Collins'})</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Added 2 labels, created 2 nodes, set 6 properties, created 1 relationship.</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-create-a-relationship-that-violates-a-relationship-key-constraint" class="discrete">Creating a relationship that violates an existing constraint will fail</h3>
<div class="exampleblock">
<div class="title">Example 68. CREATE RELATIONSHIP</div>
<div class="content">
<div class="paragraph">
<p>Create a <code>KNOWS</code> relationship without a <code>since</code> property, given a relationship key constraint on <code>:KNOWS(since, how)</code>:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH (jensen:Actor {firstname: 'Jensen', surname: 'Ackles'}), (misha:Actor {firstname: 'Misha', surname: 'Collins'})
CREATE (misha)-[:KNOWS {how: 'coworkers'}]-&gt;(jensen)</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the relationship is not created because it is missing the <code>since</code> property which is in conflict with an existing constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Relationship(0) already exists with type `KNOWS` and property `how` = 'coworkers'</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-removing-a-relationship-key-constrained-property" class="discrete">Removing a RELATIONSHIP KEY-constrained property will fail</h3>
<div class="exampleblock">
<div class="title">Example 69. REMOVE PROPERTY</div>
<div class="content">
<div class="paragraph">
<p>Remove the <code>since</code> property from an existing relationship <code>KNOWS</code>, given a <code>RELATIONSHIP KEY</code> constraint on <code>:KNOWS(since, how)</code>:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH ()-[knows:KNOWS {since: 2008, how: 'coworkers'}]-&gt;() REMOVE knows.since</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the property is not removed because it is in conflict with an existing constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Relationship(0) with type `KNOWS` must have the properties (`since`, `how`)</code></pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-fail-to-create-a-relationship-key-constraint-due-to-existing-relationship" class="discrete">Creating a constraint when there exist conflicting relationships will fail</h3>
<div class="exampleblock">
<div class="title">Example 70. CREATE CONSTRAINT</div>
<div class="content">
<div class="paragraph">
<p>Create a relationship key constraint on the property <code>level</code> on relationships with the <code>KNOWS</code> relationship type, when two relationships with identical <code>level</code> property values already exist in the graph:</p>
</div>
<div class="listingblock test-fail">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">CREATE CONSTRAINT knows_level FOR ()-[knows:KNOWS]-() REQUIRE (knows.level) IS REL KEY</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the relationship key constraint cannot be created because it is in conflict with the existing graph.
Either use <a href="../../indexes-for-search-performance/" class="xref page">Indexes for search performance</a> instead, or remove or correct the offending relationships and then re-apply the constraint.</p>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-error hljs" data-lang="error">Unable to create Constraint( name='knows_level', type='RELATIONSHIP KEY', schema=()-[:KNOWS {level}]-() ):
Both Relationship(0) and Relationship(1) have the type `KNOWS` and property `level` = 10</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The constraint creation fails on the first offending relationships that are found.
This does not guarantee that there are no other offending relationships in the graph.
Therefore, all the data should be checked and cleaned up before re-attempting the constraint creation.</p>
</div>
<div class="paragraph">
<p>This is an example <code>MATCH</code> query to find all offending relationships for the constraint above:</p>
</div>
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">MATCH ()-[knows1:KNOWS]-&gt;(), ()-[knows2:KNOWS]-&gt;()
WHERE knows1.level = knows2.level AND NOT knows1 = knows2
UNWIND [knows1, knows2] AS knows
RETURN knows, 'non-unique' AS reason
UNION
MATCH ()-[knows:KNOWS]-&gt;()
WHERE knows.level IS NULL
RETURN knows, 'non-existing' AS reason</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="constraints-examples-drop-constraint"><a class="anchor" href="#constraints-examples-drop-constraint"></a>Drop a constraint by name</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="#constraints-drop-a-constraint">Drop a constraint</a></p>
</li>
<li>
<p><a href="#constraints-drop-a-non-existing-constraint">Drop a non-existing constraint</a></p>
</li>
</ul>
</div>
<h3 id="constraints-drop-a-constraint" class="discrete">Drop a constraint</h3>
<div class="paragraph">
<p>A constraint can be dropped using the name with the <code>DROP CONSTRAINT constraint_name</code> command.
It is the same command for all constraint types.
The name of the constraint can be found using the <a href="../syntax/#constraints-syntax-list" class="xref page"><code>SHOW CONSTRAINTS</code> command</a>, given in the output column <code>name</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 71. DROP CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">DROP CONSTRAINT book_isbn</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>Removed 1 constraint.</pre>
</div>
</div>
</div>
</div>
<h3 id="constraints-drop-a-non-existing-constraint" class="discrete">Drop a non-existing constraint</h3>
<div class="paragraph">
<p>If it is uncertain if any constraint with a given name exists and you want to drop it if it does but not get an error should it not, use <code>IF EXISTS</code>.
It is the same command for all constraint types.</p>
</div>
<div class="exampleblock">
<div class="title">Example 72. DROP CONSTRAINT</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">DROP CONSTRAINT missing_constraint_name IF EXISTS</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>(no changes, no records)</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="constraints-examples-list-constraint"><a class="anchor" href="#constraints-examples-list-constraint"></a>Listing constraints</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="#constraints-listing-all-constraints">Listing all constraints</a></p>
</li>
<li>
<p><a href="#constraints-listing-constraints-with-filtering">Listing constraints with filtering</a></p>
</li>
</ul>
</div>
<h3 id="constraints-listing-all-constraints" class="discrete">Listing all constraints</h3>
<div class="paragraph">
<p>To list all constraints with the default output columns, the <code>SHOW CONSTRAINTS</code> command can be used.
If all columns are required, use <code>SHOW CONSTRAINTS YIELD *</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>One of the output columns from <code>SHOW CONSTRAINTS</code> is the name of the constraint.
This can be used to drop the constraint with the <a href="../syntax/#constraints-syntax-drop" class="xref page"><code>DROP CONSTRAINT</code> command</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="exampleblock">
<div class="title">Example 73. SHOW CONSTRAINTS</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">SHOW CONSTRAINTS</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>╒════╤══════════════════════════════╤═════════════════════════════════╤══════════════╤═══════════════╤════════════════════════════════╤═══════════════════════════════╤═════════════════════════════════╕
│"id"│"name"                        │"type"                           │"entityType"  │"labelsOrTypes"│"properties"                    │"ownedIndex"                   │"propertyType"                   │
╞════╪══════════════════════════════╪═════════════════════════════════╪══════════════╪═══════════════╪════════════════════════════════╪═══════════════════════════════╪═════════════════════════════════╡
│26  │"actor_fullname"              │"NODE_KEY"                       │"NODE"        │["Actor"]      │["firstname","surname"]         │"actor_fullname"               │null                             │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│17  │"author_name"                 │"NODE_PROPERTY_EXISTENCE"        │"NODE"        │["Author"]     │["name"]                        │null                           │null                             │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│19  │"author_pseudonym"            │"UNIQUENESS"                     │"NODE"        │["Author"]     │["pseudonym"]                   │"author_pseudonym"             │null                             │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│6   │"book_isbn2"                  │"UNIQUENESS"                     │"NODE"        │["Book"]       │["isbn2"]                       │"book_isbn2"                   │null                             │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│8   │"constraint_with_options"     │"UNIQUENESS"                     │"NODE"        │["Book"]       │["prop1","prop2"]               │"constraint_with_options"      │null                             │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│28  │"constraint_with_provider"    │"NODE_KEY"                       │"NODE"        │["Actor"]      │["surname"]                     │"constraint_with_provider"     │null                             │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│33  │"knows_since_how"             │"RELATIONSHIP_KEY"               │"RELATIONSHIP"│["KNOWS"]      │["since","how"]                 │"knows_since_how"              │null                             │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│22  │"movie_title"                 │"NODE_PROPERTY_TYPE"             │"NODE"        │["Movie"]      │["title"]                       │null                           │"STRING"                         │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│24  │"part_of"                     │"RELATIONSHIP_PROPERTY_TYPE"     │"RELATIONSHIP"│["PART_OF"]    │["order"]                       │null                           │"INTEGER"                        │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│39  │"part_of_tags"                │"RELATIONSHIP_PROPERTY_TYPE"     │"RELATIONSHIP"│["PART_OF"]    │["tags "]                       │null                           │"STRING | LIST&lt;STRING NOT NULL&gt;" │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│30  │"preExisting_actor_name_age"  │"UNIQUENESS"                     │"NODE"        │["Actor"]      │["firstname","age"]             │"preExisting_actor_name_age"   │null                             │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│10  │"preExisting_book_published"  │"UNIQUENESS"                     │"NODE"        │["Book"]       │["published"]                   │"preExisting_book_published"   │null                             │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│37  │"preExisting_how"             │"RELATIONSHIP_UNIQUENESS"        │"RELATIONSHIP"│["KNOWS"]      │["how"]                         │"preExisting_how"              │null                             │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│15  │"rel_constraint_with_options" │"RELATIONSHIP_UNIQUENESS"        │"RELATIONSHIP"│["SEQUEL_OF"]  │["order","seriesTitle","number"]│"rel_constraint_with_options"  │null                             │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│35  │"rel_constraint_with_provider"│"RELATIONSHIP_KEY"               │"RELATIONSHIP"│["KNOWS"]      │["since"]                       │"rel_constraint_with_provider" │null                             │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│13  │"sequels"                     │"RELATIONSHIP_UNIQUENESS"        │"RELATIONSHIP"│["SEQUEL_OF"]  │["order","seriesTitle"]         │"sequels"                      │null                             │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│23  │"seriesOrder"                 │"NODE_PROPERTY_TYPE"             │"NODE"        │["Movie"]      │["seriesOrder"]                 │null                           │"INTEGER"                        │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│38  │"movie_tagline"               │"NODE_PROPERTY_TYPE"             │"NODE"        │["Movie"]      │["tagline"]                     │null                           │"STRING | LIST&lt;STRING NOT NULL&gt;" │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│21  │"wrote_locations"             │"RELATIONSHIP_PROPERTY_EXISTENCE"│"RELATIONSHIP"│["WROTE"]      │["location"]                    │null                           │null                             │
├────┼──────────────────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────────────┤
│20  │"wrote_year"                  │"RELATIONSHIP_PROPERTY_EXISTENCE"│"RELATIONSHIP"│["WROTE"]      │["year"]                        │null                           │null                             │
└────┴──────────────────────────────┴─────────────────────────────────┴──────────────┴───────────────┴────────────────────────────────┴───────────────────────────────┴─────────────────────────────────┘
18 rows</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>type</code> column returns <code>UNIQUENESS</code> for the node property uniqueness constraint and <code>RELATIONSHIP_UNIQUENESS</code> for the relationship property uniqueness constraint.
This will be updated in Neo4j version 6.0.
Node property uniqueness constraints will be updated to <code>NODE_PROPERTY_UNIQUENESS</code> and relationship property uniqueness constraints to <code>RELATIONSHIP_PROPERTY_UNIQUENESS</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<h3 id="constraints-listing-constraints-with-filtering" class="discrete">Listing constraints with filtering</h3>
<div class="paragraph">
<p>One way of filtering the output from <code>SHOW CONSTRAINTS</code> by constraint type is the use of constraint type keywords,
listed in the <a href="../syntax/#constraints-syntax-list-type-filter" class="xref page">syntax for listing constraints type filter table</a>.
For example, to show only property uniqueness constraints, use <code>SHOW UNIQUENESS CONSTRAINTS</code>.
Another more flexible way of filtering the output is to use the <code>WHERE</code> clause.
An example is to only show constraints on relationships.</p>
</div>
<div class="exampleblock">
<div class="title">Example 74. SHOW CONSTRAINTS</div>
<div class="content">
<div class="listingblock">
<div class="title">Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cypher hljs" data-lang="cypher">SHOW EXISTENCE CONSTRAINTS
WHERE entityType = 'RELATIONSHIP'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will only return the default output columns.
To get all columns, use <code>SHOW INDEXES YIELD * WHERE ...</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>╒════╤═════════════════╤═════════════════════════════════╤══════════════╤═══════════════╤════════════╤════════════╤══════════════╕
│"id"│"name"           │"type"                           │"entityType"  │"labelsOrTypes"│"properties"│"ownedIndex"│"propertyType"│
╞════╪═════════════════╪═════════════════════════════════╪══════════════╪═══════════════╪════════════╪════════════╪══════════════╡
│21  │"wrote_locations"│"RELATIONSHIP_PROPERTY_EXISTENCE"│"RELATIONSHIP"│["WROTE"]      │["location"]│null        │null          │
├────┼─────────────────┼─────────────────────────────────┼──────────────┼───────────────┼────────────┼────────────┼──────────────┤
│20  │"wrote_year"     │"RELATIONSHIP_PROPERTY_EXISTENCE"│"RELATIONSHIP"│["WROTE"]      │["year"]    │null        │null          │
└────┴─────────────────┴─────────────────────────────────┴──────────────┴───────────────┴────────────┴────────────┴──────────────┘
2 rows</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="../syntax/">Syntax</a></span>

  <span class="next"><a href="../../query-tuning/">Query tuning</a></span>
</nav>
    <div class="feedback">
    <div class="header question">
        <p><strong>Was this page helpful?</strong></p>

        <svg width="22px" height="22px" viewBox="0 0 22 22" role="button" class="no" aria-label="No, this page isn't helpful">
            <path
                d="M6.25,15.8333333 C6.25,13.7622655 7.92893219,12.0833333 10,12.0833333 C12.0710678,12.0833333 13.75,13.7622655 13.75,15.8333333"
                ></path>
            <circle  cx="10" cy="10" r="9.58333333"></circle>
            <path
                d="M12.5,4.58333333 C12.8934466,4.05873783 13.5109223,3.75 14.1666667,3.75 C14.822411,3.75 15.4398867,4.05873783 15.8333333,4.58333333"
                ></path>
            <line x1="4.58333333" y1="7.91666667" x2="7.08333333" y2="7.91666667" ></line>
            <path
                d="M7.08333333,8.54166667 C6.96827401,8.54166667 6.875,8.44839266 6.875,8.33333333 C6.875,8.21827401 6.96827401,8.125 7.08333333,8.125 C7.19839266,8.125 7.29166667,8.21827401 7.29166667,8.33333333 C7.29166667,8.44839266 7.19839266,8.54166667 7.08333333,8.54166667"
                ></path>
            <line x1="12.9166667" y1="7.91666667" x2="15.4166667" y2="7.91666667" ></line>
            <path
                d="M15.4166667,8.54166667 C15.3016073,8.54166667 15.2083333,8.44839266 15.2083333,8.33333333 C15.2083333,8.21827401 15.3016073,8.125 15.4166667,8.125 C15.531726,8.125 15.625,8.21827401 15.625,8.33333333 C15.625,8.44839266 15.531726,8.54166667 15.4166667,8.54166667"
                ></path>
            <path
                d="M4.16666667,4.58333333 C4.5601133,4.05873783 5.17758895,3.75 5.83333333,3.75 C6.48907772,3.75 7.10655337,4.05873783 7.5,4.58333333"
                ></path>
        </svg>

        <svg width="22px" height="22px" viewBox="0 0 22 22" role="button" class="yes" aria-label="Yes, this page is helpful">
            <circle  cx="10" cy="10" r="9.58333333"></circle>
            <path
                d="M5.41666667,8.125 C5.53172599,8.125 5.625,8.21827401 5.625,8.33333333 C5.625,8.44839266 5.53172599,8.54166667 5.41666667,8.54166667 C5.30160734,8.54166667 5.20833333,8.44839266 5.20833333,8.33333333 C5.20833333,8.21827401 5.30160734,8.125 5.41666667,8.125"
                ></path>
            <path
                d="M14.5833333,8.125 C14.468274,8.125 14.375,8.21827401 14.375,8.33333333 C14.375,8.44839266 14.468274,8.54166667 14.5833333,8.54166667 C14.6983927,8.54166667 14.7916667,8.44839266 14.7916667,8.33333333 C14.7916667,8.21827401 14.6983927,8.125 14.5833333,8.125"
                ></path>
            <path
                d="M13.2275,12.9166657 C13.4853075,12.9162808 13.7287776,13.035241 13.8869095,13.2388563 C14.0450415,13.4424715 14.1000278,13.7078123 14.0358333,13.9575 C13.562901,15.7999679 11.9021969,17.0882321 10,17.0882321 C8.09780311,17.0882321 6.43709903,15.7999679 5.96416667,13.9575 C5.89997223,13.7078123 5.95495852,13.4424715 6.11309045,13.2388563 C6.27122239,13.035241 6.51469246,12.9162808 6.7725,12.9166657 L13.2275,12.9166657 Z"
                ></path>
        </svg>
    </div>


</div></article>
<aside class="toc sidebar" data-title="Contents"
  data-levels="2">
  <div class="toc-menu">
    <div class="toc-menu-placeholder"></div>

      </div>
  </aside>  </div>
</main>
</div>
<footer class="footer">
  <div class="wrapper">
  <div class="column">
    <div class="logo-footer"></div>
    <p>© <span id="footer-copyright-year">2023</span> Neo4j, Inc.<br>
      <a href="https://neo4j.com/terms/">Terms</a> | <a href="https://neo4j.com/privacy-policy/">Privacy </a> | <a href="https://neo4j.com/sitemap/">Sitemap</a></p>
    <p>Neo4j<sup>®</sup>, Neo Technology<sup>®</sup>, Cypher<sup>®</sup>, Neo4j<sup>®</sup> Bloom<sup>™</sup> and
      Neo4j<sup>®</sup> Aura<sup>™</sup> are registered trademarks
      of Neo4j, Inc. All other marks are owned by their respective companies.</p>
  </div>

  <div class="column">
    <h2><a href="https://neo4j.com/contact-us/?ref=footer">Contact Us →</a></h2>
    <p>US: 1-855-636-4532<br>
      Sweden +46 171 480 113<br>
      UK: +44 20 3868 3223<br>
      France: +33 (0) 1 88 46 13 20<br>
      <!--Germany: +49 (0)89 26204 6300</p>-->
    </p>
  </div>
  <div class="column links">
    <h2>Learn</h2>
    <ul>
      <li><i class="fa fa-wrench" aria-hidden="true"></i> <a rel="noopener" href="https://neo4j.com/sandbox/?ref=developer-footer">Sandbox</a></li>
      <li><i class="fa fa-comments-o" aria-hidden="true"></i> <a rel="noopener" href="https://community.neo4j.com?ref=developer-footer" target="_blank">Neo4j Community Site</a></li>
      <li><i class="fa fa-book" aria-hidden="true"></i> <a rel="noopener" href="https://medium.com/neo4j" target="_blank">Neo4j Developer Blog</a></li>
      <li><i class="fa fa-youtube" aria-hidden="true"></i> <a rel="noopener" href="https://www.youtube.com/neo4j" target="_blank">Neo4j Videos</a></li>
      <li><i class="fa fa-graduation-cap" aria-hidden="true"></i> <a rel="noopener" href="https://neo4j.com/graphacademy/?ref=developer-footer">GraphAcademy</a></li>
      <li><i class="fa fa-flask" aria-hidden="true"></i> <a href="https://neo4j.com/labs/?ref=developer-footer">Neo4j Labs</a></li>
    </ul>
  </div>
  <div class="column links">
    <h2>Social</h2>
    <ul>
      <li><i class="fa fa-twitter" aria-hidden="true"></i> <a rel="noopener" href="https://twitter.com/neo4j" target="_blank">Twitter</a></li>
      <li><i class="fa fa-meetup" aria-hidden="true"></i> <a rel="noopener" href="https://www.meetup.com/Neo4j-Online-Meetup/" target="_blank">Meetups</a></li>
      <li><i class="fa fa-github" aria-hidden="true"></i> <a rel="noopener" href="https://github.com/neo4j/neo4j" target="_blank">Github</a></li>
      <li><i class="fa fa-stack-overflow" aria-hidden="true"></i> <a rel="noopener" href="https://stackoverflow.com/questions/tagged/neo4j" target="_blank">Stack Overflow</a></li>

      <li class="speaker-program"><a href="https://docs.google.com/forms/d/e/1FAIpQLSdEcNnMruES5iwvOVYovmS1D_P1ZL_HdUOitFrwrvruv5PZvA/viewform">Want to Speak?</a></li>
    </ul>
  </div>
</div>
</footer>

  <script src="../../../../assets/js/vendor/auth0.js"></script>
  <script src="../../../../assets/js/site.js"></script>
  <script async src="../../../../assets/js/vendor/highlight.js"></script>
  <script async src="../../../../assets/js/vendor/image-zoom.js"></script>


<div id="neo4j-algolia-search-v2"></div>
<script src="https://neo4j.com/wp-content/themes/neo4jweb/assets/neo4j-react-modules-assets/search-preact/chunkless/bundle.js"></script>
<script src="https://neo4j.com/wp-content/themes/neo4jweb/assets/neo4j-react-modules-assets/search-preact/chunkless/polyfill.js"></script>
<script>window.algoliaSearchOptions = {indexName: "docs",placeholder: "Search Documentation",template: "docs"}</script>  </body>
</html>
